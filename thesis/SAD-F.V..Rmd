---
title: "Statistica e Analisi dei Dati"
author: "Francesco Vicidomini"
date: "28/7/2019"
output: 
    pdf_document: 
        toc: yes
---

```{r setup, include=FALSE}
library(readxl)
library(knitr)
library(randomcoloR)
source("../scripts/utils.R")
knitr::opts_chunk$set(echo = TRUE)
```
<!--numerazione dell'inidice-->
\setcounter{page}{1} 		
\pagenumbering{roman} 
<!--\listoftables-->
\listoffigures
\newpage
<!--numerazione della tesina -->
\setcounter{page}{1} 		
\pagenumbering{arabic} 
# 1. Introduzione
L'obiettivo del progetto è quello di analizzare e confrontare il numero di laureati(delle università pubbliche) fra le varie regioni italiane nell'anno 2016, i dati sono stati presi dal sito _[dati.istat](http://dati.istat.it/)_ in formato xlsx e sono stati importati in R utilizzando la funzione **read_excel** dopodichè le informazioni delle colonne del dataset vengono salvate nelle  seguenti variabili 
```{r}
ds <- read_excel("../dataset/dataset.xlsx", 
                 skip = 1)

```

Una volta importato il dataset essopresenta i segenti valori  
\begin{figure}[h]
\begin{center}
\includegraphics[width=350px]{../img/ds.png}
\caption{Il dataset}
\end{center}
\end{figure}

Per semplificare il lavoro i valori delle colonne vengono salvati all'interno delle variabili che vedere riportate di seguito
```{r}
#variabili
regioni <- c("Piemonte", "Valle d'Aosta", "Liguria", "Lombardia",
             "T. Alto Adige", "Veneto", "F.V.Giulia", "E. Romagna",
             "Toscana", "Umbria", "Marche", "Lazio", "Abruzzo",
             "Molise", "Compania", "Puglia", "Basilicata",
             "Calabria", "Sicilia", "Sardegna")
row.names(ds) <- regioni
triennale <- ds$`corsi di laurea di I livello`
magistrale <- ds$`corsi di laurea magistrale biennale`
unico <- ds$`corsi di laurea magistrale a ciclo unico`
vecchio <- ds$`corsi di laurea del vecchio ordinamento`
```

## 1.1 Calcolo dei tassi
I valori risultano molto altalenanti, quindi potrebbero risultare difficili da rappresentare graficamente in futuro, per ovviare a questo problema si è pensato di rappresentare i dati come tasso di laureati per regione ogni mille abitanti, i valori sono stati poi arrotondati alle sole prime tre cifre decimale, il dataset dopo la trasformazione si presenta nel seguente modo:

\begin{figure}[h]
\begin{center}
\includegraphics[width=450px]{../img/dsTassi.png}
\caption{Tasso di laureati ogni mille abitanti}
\end{center}
\end{figure}

I valori sono stati calcolati utilizzando i seguenti comandi:

```{r}
popolazione <- c(4404000, 127329, 1571000, 10010000,
                 1062860, 4915000, 1221000, 4448000,
                 3744000, 891181, 1544000, 5888000, 
                 1327000, 312027, 5851000, 4077000,
                 573694, 1971000, 5074000, 1658000)
tassoTriennale <- (triennale / popolazione) * 1000
tassoMagistrale <- (magistrale / popolazione) * 1000
tassoUnico <- (unico / popolazione) * 1000
tassoVecchio <- (vecchio / popolazione) * 1000
totaleTassi <- tassoTriennale + tassoMagistrale + tassoUnico + tassoVecchio
dsTassi <- data.frame("Tasso laureati triennali"=round(tassoTriennale, digits = 3),
                      "Tasso laureati magistrali"=round(tassoMagistrale, digits = 3),
                      "Tasso laureati a ciclo unico"=round(tassoUnico, digits = 3),
                      "Tasso laureati vecchio ordinamento"=round(tassoVecchio, digits = 3),
                      "Totale"= round(totaleTassi,digits = 3))
dsPopolazione <- data.frame("Popolazione"=popolazione)
row.names(dsPopolazione) <- regioni
row.names(dsTassi) <- regioni

```

Nel data frame **dsPopolazione** sono presenti il numero di abitanti di ogni regione italiana nell'anno 2016; nel data frame **dsTassi** sono presenti i tassi di laureati per ogni regioni italiana per ogni tipo di laurea e anche il totale dei tassi.

# 2. Grafici a barre
Per una rapida visualizzazione dei dati si è deciso di mostrare i grafici a barre dei laureati nelle varie regioni d'Italia. I grafici verranno mostrati con la funzione scritta ad hoc **showBar**
```{r}
showBar
```
essa prende in input un dei vettori dei tassi, i nomi delle regioni per definire le label della legenda, il nome del grafico e il numero di righe del dataframe, i colori delle barre sono stati definiti grazie alla funzione **distinctColorPalette** della libreria **randomcoloR**.

## 2.1 Grafico dei tassi dei laureati triennali
```{r}
rowTassi <- nrow(dsTassi)
showBar(tassoTriennale, regioni, "Tassi Triennale", rowTassi, "topleft")
```

Il grafico ci dice che la regione con il più alto tasso di laureati triennali è l'Abruzzo(4.5) mentre la regione con il tasso più basso è la Basilicata(0.88).

## 2.2 Grafico dei tassi dei laureati magistrali
```{r}
showBar(tassoMagistrale, regioni, "Tassi Magistrale", rowTassi, "topright")
```

I tassi per i laureati magistrali si abbassano, questo è normale perchè bisogna considare il fatto che la popolazione resta sempre la stessa ma il numero di laureati Magistrali è molto più basso rispetto a quello dei laureati triennali.  
Il tasso più alto viene registrato in Emilia-Romagna(2.01), l'Abruzzo che aveva il più alto tasso di laureati Triennali continua ad avere un tasso abbastanza alto pari a 1.88, il tasso più basso viene registrato dalla Valle d'Aosta con un tasso di laureati magistrali pari a 0.09.

## 2.3 Grafico dei tassi dei laureati a ciclo unico
```{r}
showBar(tassoUnico, regioni, "Tassi ciclo unico", rowTassi,"topleft")
```

Anche in questo caso i tassi si abbassano ulteriormente dato che i laureati a ciclo unico per ogni regione sono molto meno rispetto a laureati Triennali e Magistrali.  
La regione con il tasso più alto è di nuovo l'Abruzzo con 0.93 mentre la regione con il tasso più basso è la Valle d'Aosta con 0.02.

## 2.4 Grafico dei tassi dei laureati con il vecchio ordinamento
```{r}
showBar(tassoVecchio, regioni, "Tasso vecchio ordinamento", rowTassi, "topright")
```
Per i laureati registramo i tassi più bassi di tutti dato che il numero di totale di laureati con il vecchio ordinamento in Italia nel 2016 è pari a 2727. La regione con il tasso più alto resta l'Abruzzo con 0.10, il tasso più basso si registra in Umbria avente un tasso pari a 0.

## 2.5 Grafico dei tassi dei laureati totali
```{r}
showBar(totaleTassi, regioni, "Tasso di tutti i laureati", rowTassi, "topleft")
```

La regione con il tasso più alto di laureati è l'Abruzzo con un tasso pari a 7.44 mentre la regione con il tasso più basso è la Basilicata con 1.49.

# 3. Diagramma di Pareto
La legge del Principio di Pareto(Legge dell'80/20) afferma che _"la maggior parte degli effetti dipendono da un numero ristretto di cause"_. Per costruire il diagramma di Pareto occorre classificare i dati, ordinarli, disegnare un grafico a barre, aggiungere la linea cumulativa e aggiungere le informazioni di base.  
Come dati da classificare è stato scelto il totale dei tassi di laureti italiani, di seguito viene mostrata la funzione utilizzata per costruire il diagramma.
```{r eval=FALSE, echo=TRUE}
showPareto <- function(totale, main, rows){
    #ordiniamo il dataset
    ordinato <- dsTassi[order(dsTassi$Totale, decreasing = TRUE),]
    #prendiamo le regioni ordinate
    lbls <- rownames(ordinato)
    #prendiamo il totale
    ordinato <- ordinato$Totale
    freqRel <- prop.table(ordinato)
    app <- data.frame(ordinato)
    pal<- distinctColorPalette(rows)
    x<- barplot(freqRel, ylim= c(0, 1.5), main = main, col=pal, axisname = FALSE)
    axis(1, las=2, hadj= 0.6, at=x, labels=lbls, line=1, col="transparent")
    lines(x, cumsum(freqRel), type = "b", pch=16)
    text(x-0.2, cumsum(freqRel) + 0.03, paste(format(cumsum(freqRel)*100, digits = 3), "%"))
}

showPareto(totaleTassi, "Diagramma di Pareto di tutti i laureati nel 2016", rowTassi)
```
\newpage
\begin{figure}[t]
\includegraphics{../img/pareto.png}
\caption{Pareto dei laureati italiani}
\end{figure}
Dal grafico si evince che:

- l'8.56% dei laureati italiani è abruzzese
- il 75.89% dei laureati italiani è abruzzese, romagnolo, laziale, marchigiano, umbro, friulano, toscano, campano, veneto, piemontese, molisano, alto adesino, lombardo
- il 15,55% dei laureati italiani vive nelle restanti sette regioni
Possiamo dire che il principio di Pareto non è soddisfatto perchè l'80% dei laureati esce dal più del 50% delle università sparse per le varie regioni(invece che nel 20%).

# 4. Retta di regressione
La relazione fra due variabili quantitative può essere rappresentata graficamente con un diagramma di dispessione(anche detto scatterplot). Per poter costruire questo grafico abbiamo bisogno di individuare le due variabili da mettere in relazione, la coppia di variabili è formata da una variabile **dipendente**(posta sull'asse delle Y) e una **indipendente**(posta sull'asse delle X); ogni coppia di osservazioni viene rappresentata come un punto. Il risultato finale sarà un grafico contenente un insieme di punti attraverso il quale cerchiamo di individuare un trend.  
La correlazione tra le variabili quantitative si ricava tramite la **covarianza** che indica quanto le due variabili variano insieme, ovvero quanto esse siano dipendenti.  
Il **coefficiente di correlazione** ci consente di misurare la "forza" del legame fra le due variabili prese in esame.  
Le variabili prese in esame sono:

- dipendente
- indipendente